<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cabin Crew Quiz</title>
  <style>
    body.dark-mode { background: #1e1e1e; color: #ffffff; }
    .dark-mode .question { background: #2e2e2e; color: #f0f0f0; box-shadow: 0 0 10px rgba(255,255,255,0.05); }
    .dark-mode .submit-btn { background: #444; color: white; }
    .dark-mode #timer { color: #ffcc00; }
    body { font-family: sans-serif; background: #f9f9f9; padding: 2rem; }
    .question { background: #fff; border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .question h3 { margin-top: 0; }
    .options label { display: block; margin: 0.25rem 0; }
    .submit-btn { background: #007bff; color: white; padding: 0.5rem 1rem; border: none; border-radius: 0.25rem; cursor: pointer; margin-top: 1rem; }
    .result { margin-top: 1rem; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Cabin Crew Quiz</h1>
  <form id="quizForm">
    <label>Enter your name:</label>
    <input type="text" id="username" required style="margin-bottom: 1rem; display: block; padding: 0.5rem; width: 100%; max-width: 400px;">
    <div id="questionsContainer"></div>
    <button type="submit" class="submit-btn">Submit Quiz</button>
  </form>

  <div id="scoreDisplay" class="result"></div>
  <div id="remoteResults"></div>

<script>
window.onload = function () {
  const questions = [
  {
    question: "What is the first action during sudden decompression?",
    options: ["Notify the captain", "Secure the cabin", "Grab oxygen mask", "Inform passengers"],
    correct: "C"
  },
  {
    question: "Which passenger requires special handling before takeoff?",
    options: ["Passenger with crutches", "Unaccompanied minor", "Infant with parent", "Passenger in business class"],
    correct: "B"
  },
  {
    question: "How should a passenger with a broken leg be seated?",
    options: ["Any free seat", "Next to an emergency exit", "Aisle seat with leg extended", "Middle seat"],
    correct: "C"
  },
  {
    question: "What is the correct procedure during moderate turbulence?",
    options: ["Continue service", "Secure trolleys and sit down", "Go to cockpit", "Evacuate passengers"],
    correct: "B"
  },
  {
    question: "How to identify a hidden disability?",
    options: ["Medical bracelet", "By asking directly", "Behavior observation", "Through ID card"],
    correct: "C"
  },
  {
    question: "Who can approve the use of a passengerâ€™s portable oxygen concentrator?",
    options: ["Cabin crew", "Captain", "Medical team at airport", "Another passenger"],
    correct: "B"
  },
  {
    question: "When must cabin crew brief passengers with reduced mobility?",
    options: ["Only during long-haul flights", "After takeoff", "Before takeoff", "Before landing"],
    correct: "C"
  },
  {
    question: "What is the correct response to an unconscious passenger?",
    options: ["Give water", "Start CPR", "Shake the passenger", "Call ground medical support"],
    correct: "B"
  },
  {
    question: "How should infants be secured during turbulence?",
    options: ["In arms", "With seat belt extension", "On floor", "Standing with parent"],
    correct: "B"
  },
  {
    question: "Which passenger must never be seated in an emergency exit row?",
    options: ["Able-bodied adult", "Frequent flyer", "Pregnant woman", "Passenger with glasses"],
    correct: "C"
  }
  
];
  questions.forEach((q, idx) => {
    const div = document.createElement("div");
    div.className = "question";
    div.innerHTML = `<h3>${q.question}</h3>` + q.options.map(opt => `
      <label><input type="radio" name="q${idx}" value="${opt}" required /> ${opt}</label>
    `).join('');
    questionsContainer.appendChild(div);
  });

  const form = document.getElementById("quizForm");
  form.addEventListener("submit", function(e) {
    e.preventDefault();
    const name = document.getElementById("username").value.trim();
    let score = 0;
    questions.forEach((q, idx) => {
      const selected = document.querySelector(`input[name='q${idx}']:checked`);
      if (selected && selected.value === q.correct) score++;
    });

    document.getElementById("scoreDisplay").innerText = `You scored ${score} out of ${questions.length}`;

    const payload = { name, score, total: questions.length };

    fetch("https://script.google.com/macros/s/AKfycbzb-Pwrh5dIeIiyVc3UsUYc_2j_WbgMHyvZNW4Wi3XF0vHgGqrzRQVo4snxRvz5GSW3/exec", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    }).then(res => res.text()).then(resp => {
      console.log("Saved:", resp);
      loadResults();
    });
  });

  loadResults();
};

async function loadResults() {
  try {
    const response = await fetch("https://script.google.com/macros/s/AKfycbzb-Pwrh5dIeIiyVc3UsUYc_2j_WbgMHyvZNW4Wi3XF0vHgGqrzRQVo4snxRvz5GSW3/exec");
    const text = await response.text();
    const json = JSON.parse(text);
    const container = document.getElementById("remoteResults");
    container.innerHTML = `<h2>All Participants</h2>`;
    const table = document.createElement("table");
    table.style.borderCollapse = "collapse";
    table.style.width = "100%";
    table.innerHTML = `<tr><th style='border:1px solid #ccc;padding:8px;'>Name</th><th style='border:1px solid #ccc;padding:8px;'>Score</th><th style='border:1px solid #ccc;padding:8px;'>Total</th><th style='border:1px solid #ccc;padding:8px;'>Date</th></tr>` +
      json.map(row => `<tr><td style='border:1px solid #ccc;padding:8px;'>${row.name}</td><td style='border:1px solid #ccc;padding:8px;'>${row.score}</td><td style='border:1px solid #ccc;padding:8px;'>${row.total}</td><td style='border:1px solid #ccc;padding:8px;'>${row.date}</td></tr>`).join('');
    container.appendChild(table);
  } catch (err) {
    console.error("Failed to load shared results", err);
  }
}
</script>
</body>
</html>


